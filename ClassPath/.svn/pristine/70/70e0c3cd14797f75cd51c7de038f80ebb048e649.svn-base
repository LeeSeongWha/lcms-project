<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%>
<%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt"%>
<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>부경대학교 학생포털 - 메인</title>
<link
	href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css"
	rel="stylesheet">
<link href="/dist/assets/css/index.css" rel="stylesheet" />
</head>
<body>
	<div class="container">
		<!-- Header -->
		<div class="header">
			<div class="header-content">
				<div class="welcome-text">
					<h1>안녕하세요, ${student.userName}님</h1>
					<p>오늘도 좋은 하루 되세요!</p>
				</div>
				<div class="date-info">
					<div class="semester">${currentSemester}</div>
					<div>
						<fmt:formatDate value="${currentDate}" pattern="yyyy년 MM월 dd일 (E)" />
					</div>
				</div>
			</div>
		</div>

		<!-- Quick Actions -->
		<div class="quick-actions">
			<a href="http://localhost:6060/eclass/lecture/${student.userNo}"
				class="quick-action"> <i class="fas fa-tasks"></i>
				<h3>과제 제출</h3>
				<p>미제출 과제 ${assignmentCount}건</p>
			</a> <a href="/student/grade/history.do" class="quick-action"> <i
				class="fas fa-chart-bar"></i>
				<h3>성적 조회</h3>
				<p>${gradeStatus}</p>
			</a> <a href="/student/lecture/enroll.do" class="quick-action"> <i
				class="fas fa-plus"></i>
				<h3>수강신청</h3>
				<p>2025-07-03 ~ 2025-08-20</p>
			</a> <a href="/student/schedule" class="quick-action"> <i
				class="far fa-calendar-alt"></i>
				<h3>캘린더</h3>
			</a>
		</div>

		<!-- Main Content -->
		<div class="main-content">
			<!-- Left Column -->
			<div class="left-column">
				<!-- Current Courses -->
				<div class="card">
					<h2>
						<i class="fas fa-graduation-cap"></i>수강 중인 과목
					</h2>
					<c:choose>
						<c:when test="${not empty currentCourses}">
							<c:forEach var="course" items="${currentCourses}">
								<div class="course-item">
									<div class="course-header">
										<div>
											<a
												href="http://localhost:6060/eclass/lecture/${student.userNo }/${course.lecNo }/assignment">
												<div class="course-title">${course.lectureReq.lecName}</div>
											</a>
											<div class="course-code">${course.professorName}</div>
										</div>
									</div>
								</div>
							</c:forEach>
						</c:when>
						<c:otherwise>
							<div class="empty-message">수강 중인 과목이 없습니다.</div>
						</c:otherwise>
					</c:choose>
				</div>

				<!-- Today's Schedule -->
				<div class="card">
					<h2>
						<i class="fas fa-calendar-day"></i>오늘의 일정
					</h2>
					<c:choose>
						<c:when test="${not empty todaySchedule}">
							<c:forEach var="schedule" items="${todaySchedule}">
								<div class="schedule-item">
									<div class="schedule-time">${schedule.startTime}</div>
									<div class="schedule-info">
										<div class="schedule-title">${schedule.scheduleTitle}</div>
									</div>
								</div>
							</c:forEach>
						</c:when>
						<c:otherwise>
							<div class="empty-message">오늘 일정이 없습니다.</div>
						</c:otherwise>
					</c:choose>
				</div>
			</div>

			<!-- Right Column -->
			<div class="right-column">
				<!-- Academic Status -->
				<div class="card">
					<h2>
						<i class="fas fa-chart-line"></i>학업 현황
					</h2>
					<div class="status-grid">
						<div class="status-item">
							<div class="status-value">
								<fmt:formatNumber value="${academicStatus.gpa}" pattern="0.00" />
							</div>
							<div class="status-label">평균 학점</div>
						</div>
						<div class="status-item">
							<div class="status-value">${academicStatus.totalCredits}</div>
							<div class="status-label">취득 학점</div>
						</div>
					</div>
					<div class="status-grid">
						<div class="status-item">
							<div class="status-value">${academicStatus.currentSemesterCredits}</div>
							<div class="status-label">이번학기</div>
						</div>
						<div class="status-item">
							<div class="status-value">${academicStatus.graduationProgress}%</div>
							<div class="status-label">졸업 진도</div>
						</div>
					</div>
				</div>

				<!-- Recent Notices -->
				<div class="card-notice">
					<h2>
						<i class="fas fa-bell"></i>최근 공지사항
					</h2>
					<c:choose>
						<c:when test="${not empty recentNotices}">
							<c:forEach var="notice" items="${recentNotices}">
								<div class="notice-item"
									onclick="location.href='/student/notice/noticeDetail.do?boardNo=${notice.boardNo}'">
									<div class="notice-title">${notice.boardTitle}</div>
									<div class="notice-date">${notice.postDate}</div>
								</div>
							</c:forEach>
						</c:when>
						<c:otherwise>
							<div class="empty-message">최근 공지사항이 없습니다.</div>
						</c:otherwise>
					</c:choose>
				</div>
			</div>
		</div>
	</div>

	<script>
        // 간단한 인터랙션 효과
        document.querySelectorAll('.quick-action').forEach(action => {
            action.addEventListener('click', function(e) {
                this.style.transform = 'scale(0.95)';
                setTimeout(() => {
                    this.style.transform = '';
                }, 150);
            });
        });

        // 진행률 애니메이션
        window.addEventListener('load', function() {
            document.querySelectorAll('.course-progress-bar').forEach(bar => {
                const width = bar.style.width;
                bar.style.width = '0%';
                setTimeout(() => {
                    bar.style.width = width;
                }, 500);
            });
        });
    </script>
</body>
</html>