<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="jakarta.tags.core"%>

<%--
    파일명 : facilityList.jsp
    프로그렴명 : 시설 전체 조회 화면
    설 명 : 등록된 시설물 전체를 조회할 수 있음.
    작성자 : 양 수 민
    작성일 : 2025. 07. 01
--%>	


  <title>시설 관리</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">


  <div class="max-w-6xl mx-auto bg-white rounded-xl shadow p-6">
    <div class="flex justify-between items-center mb-6">
      <h2 class="text-2xl font-bold text-blue-700">시설 관리</h2>
      <button onclick="showAddFacilityPage()" class="bg-green-500 hover:bg-green-600 text-white px-4 py-2 rounded">+ 새 시설 등록</button>
    </div>

    <!-- 시설 검색 -->
    <div class="mb-6">
      <div class="flex space-x-2">
        <input type="text" id="facilitySearchInput" placeholder="시설명 또는 시설 유형으로 검색"
               class="flex-grow border border-gray-300 px-4 py-2 rounded focus:outline-none focus:ring-2 focus:ring-blue-400">
        <button onclick="searchFacilities()" class="bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded">검색</button>
      </div>
    </div>

    <!-- 시설 목록 -->
    <div class="overflow-x-auto">
      <table class="min-w-full table-auto border border-gray-200 rounded">
        <thead class="bg-gray-100">
          <tr>
<!--             <th class="px-4 py-2 text-left border">시설 코드</th> -->
            <th class="px-4 py-2 text-left border">시설명</th>
            <th class="px-4 py-2 text-left border">시설 유형</th>
            <th class="px-4 py-2 text-left border">위치</th>
            <th class="px-4 py-2 text-left border">수용 인원</th>
            <th class="px-4 py-2 text-left border">시간표</th>
          </tr>
        </thead>
        <tbody id="facilityTableBody" class="bg-white divide-y divide-gray-100">
          <c:choose>
			<c:when test="${not empty facility }">
				<c:forEach items="${facility }" var="facility">
					<c:url value="/staff/facility/facilityDetail.do" var="detailURL">
						<c:param name="what" value="${facility.facilityNo }" />
					</c:url>
					<tr>
<%-- 						<td class="px-4 py-2 border">${facility.facilityNo}</td> --%>
				        <td class="px-4 py-2 border"><a href="${detailURL }">${facility.facilityName}</a></td>
				        <td class="px-4 py-2 border">${facility.facilityType}</td>
				        <td class="px-4 py-2 border">${facility.location}</td>
				        <td class="px-4 py-2 border">${facility.facilityMp}</td>
				        <td class="px-4 py-2 border"><a href="/staff/reservationTimestamp/facility/facility.do">바로가기</a></td>
					</tr>
				</c:forEach>
			</c:when>

			<c:otherwise>
				<tr>
					<td colspan="4">아직 시설 없음.</td>
				</tr>
			</c:otherwise>
		</c:choose>
        </tbody>
      </table>
    </div>
  </div>

<script>
  function searchFacilities() {
    const searchInput = document.getElementById('facilitySearchInput').value.toLowerCase();
    const tableRows = document.getElementById('facilityTableBody').getElementsByTagName('tr');

    for (let i = 0; i < tableRows.length; i++) {
      const row = tableRows[i];
      const facilityName = row.cells[0] ? row.cells[0].textContent.toLowerCase() : '';
      const facilityType = row.cells[1] ? row.cells[1].textContent.toLowerCase() : '';

      if (facilityName.includes(searchInput) || facilityType.includes(searchInput)) {
        row.style.display = '';
      } else {
        row.style.display = 'none';
      }
    }
  }

  document.getElementById('facilitySearchInput').addEventListener('keyup', function(event) {
    if (event.key === 'Enter') {
      searchFacilities();
    }
  });

  function showAddFacilityPage() {
    alert('새 시설 등록 페이지로 이동합니다.');
    window.location.href = '/staff/facility/facilityInsert.do'; 
  }
</script>



