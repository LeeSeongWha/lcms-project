package kr.or.ddit.pfcp.professor.data.controller;

import java.util.HashMap;
import java.util.List;
import java.util.Map;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RestController;

import kr.or.ddit.pfcp.professor.data.service.ProfessorDataRestService;
import lombok.RequiredArgsConstructor;
import lombok.extern.slf4j.Slf4j;

/**
 * @author 김태수
 * @since 2025. 7. 28.
 *
 * << 개정이력(Modification Information) >>
 *  수정일     |   수정자   |   수정 내용
 * -----------------------------------------------
 * 2025. 7. 28. | 김태수   | 최초 생성
 * 2025. 7. 29. | 김태수   | 학과별 학생 통계 기능 추가
 */
@RestController
@RequestMapping("/rest/professorData")
@Slf4j
public class ProfessorDataRestController {
	
	@Autowired
    private ProfessorDataRestService professorDataRestService;

    @GetMapping
    public Map<String, Object> getProfessorStatistics(@RequestParam("departmentNo") String departmentNo) {
        log.info("학과 통계 데이터 요청 수신 - departmentNo: {}", departmentNo);

        Map<String, Object> result = new HashMap<>();

        result.put("totalStd", professorDataRestService.totalStd(departmentNo));
        result.put("currentStd", professorDataRestService.currentStd(departmentNo));
        result.put("gradStd", professorDataRestService.gradStd(departmentNo));
        result.put("leaveStd", professorDataRestService.leaveStd(departmentNo));

        List<Map<String, Object>> admYearData = professorDataRestService.admYearCnt(departmentNo);
        result.put("admYearCnt", admYearData);

        List<Map<String, Object>> gradeData = professorDataRestService.gradeCnt(departmentNo);
        result.put("gradeCnt", gradeData);


        return result;
    }
}
