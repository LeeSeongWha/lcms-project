<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.or.ddit.pfcp.student.bill.scholarship.mapper.StudentScholarshipMapper">
	<resultMap id="scholarshipMap" type="kr.or.ddit.pfcp.common.vo.ScholarshipVO">
    <id property="scholarshipNo" column="SCHOLARSHIP_NO"/>
    <result property="rnum" column="RNUM"/>
    <result property="userNo" column="USER_NO"/>
    <result property="schTypeNo" column="SCH_TYPE_NO"/>
    <result property="tuitionAmount" column="TUITION_AMOUNT"/>
    <result property="disAmount" column="DIS_AMOUNT"/>
    <result property="applyDate" column="APPLY_DATE"/>

	    <association property="scholarshipType" javaType="kr.or.ddit.pfcp.common.vo.ScholarshipTypeVO">
	        <id property="schTypeNo" column="SCH_TYPE_NO"/>
	        <result property="schName" column="SCH_NAME"/>
	        <result property="rate" column="RATE"/>
	        <result property="schDesp" column="SCH_DESP"/>
	        <result property="schActive" column="SCH_ACTIVE"/>
	    </association>
	</resultMap>


	<select id="selectScholarshipBenefitList" resultMap="scholarshipMap">
		SELECT ROW_NUMBER() OVER (ORDER BY A.APPLY_DATE DESC) AS RNUM
			   , A.SCHOLARSHIP_NO
			   , A.USER_NO
			   , A.SCH_TYPE_NO
			   , A.TUITION_AMOUNT
			   , A.DIS_AMOUNT
			   , SUBSTR(A.APPLY_DATE, 1, 10) AS APPLY_DATE
			   , B.SCH_TYPE_NO AS SCH_TYPE_NO
			   , B.SCH_NAME
			   , B.RATE
			   , B.SCH_DESP
			   , B.SCH_ACTIVE
  		  FROM SCHOLARSHIP A
	INNER JOIN SCHOLARSHIP_TYPE B ON A.SCH_TYPE_NO = B.SCH_TYPE_NO
 		 WHERE A.USER_NO = #{userNo}
	</select>

</mapper>