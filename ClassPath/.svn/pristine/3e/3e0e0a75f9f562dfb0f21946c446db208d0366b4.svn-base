<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<%@ taglib prefix="c" uri="jakarta.tags.core"%>

<link rel="stylesheet" href="/dist/assets/css/bodyFormat.css">
<title>졸업 요건 현황</title>

<c:if test="${not empty success}">
	<script>
		alert("${success}");
	</script>
</c:if>

<!-- =================== 헤더 영역 =================== -->
<div class="sectionHeaderLine">
	<div>
		<div class="sectionHeaderTitle">졸업 요건 현황</div>
		<div class="sectionHeaderDescription">전체 ${count}명의 학생</div>
	</div>
</div>

<!-- =================== 검색 영역 =================== -->
<form method="get" action="/staff/applyGrd/graduateApply.do"
	style="margin-bottom: 1rem;">
	<select name="searchType">
		<option value="all" ${searchType == 'all' ? 'selected' : ''}>전체</option>
		<option value="userNo" ${searchType == 'userNo' ? 'selected' : ''}>학번</option>
		<option value="userName" ${searchType == 'userName' ? 'selected' : ''}>이름</option>
	</select> <input type="text" name="keyword" value="${keyword}"
		placeholder="검색어 입력" />
	<button type="submit" class="submitButton">검색</button>
</form>

<!-- =================== 테이블 영역 =================== -->
<div class="tableContainer" id="gradListArea">
	<table class="defaultTable">
		<thead class="tableHead">
			<tr>
				<th class="tableTh">번호</th>
				<th class="tableTh">학번</th>
				<th class="tableTh">이름</th>
				<th class="tableTh">학과</th>
				<th class="tableTh">총 이수 학점</th>
				<th class="tableTh">전공 이수</th>
				<th class="tableTh">교양 이수</th>
				<th class="tableTh">졸업 가능</th>
			</tr>
		</thead>
		<tbody>
			<c:choose>
				<c:when test="${not empty grdList}">
					<c:forEach items="${grdList}" var="grd" varStatus="status">
						<tr>
							<td class="tableTd">${paging.firstRecordIndex + status.index}</td>
							<td class="tableTd">${grd.userNo}</td>
							<td class="tableTd">${grd.userName}</td>
							<td class="tableTd">${grd.departmentNo}</td>
							<td class="tableTd">${grd.totalCredit}</td>
							<td class="tableTd">${grd.majorCredit}</td>
							<td class="tableTd">${grd.generalCredit}</td>
							<td class="tableTd"><c:choose>
									<c:when test="${grd.graduationEligible eq 'Y'}">
										<span class="badge badgeGreen">가능</span>
									</c:when>
									<c:otherwise>
										<span class="badge badgeRed">불가</span>
									</c:otherwise>
								</c:choose></td>
						</tr>
					</c:forEach>
				</c:when>
				<c:otherwise>
					<tr>
						<td colspan="8" class="tableTd noticeInfo">조회된 졸업요건 정보가 없습니다.</td>
					</tr>
				</c:otherwise>
			</c:choose>
		</tbody>
	</table>
</div>

<!-- =================== 페이징 영역 =================== -->
<div class="pagination">
	<!-- 이전 블록: 현재 시작 페이지가 1보다 클 때만 출력 -->
	<c:if test="${paging.firstPageNoOnPageList > 1}">
		<a
			href="?page=${paging.firstPageNoOnPageList - paging.pageSize}&searchType=${searchType}&keyword=${keyword}"
			class="pageButton">이전</a>
	</c:if>

	<!-- 숫자 버튼: 최대 총 페이지 수를 넘지 않도록 제한 -->
	<c:forEach var="i" begin="${paging.firstPageNoOnPageList}"
		end="${paging.totalPageCount < paging.lastPageNoOnPageList ? paging.totalPageCount : paging.lastPageNoOnPageList}">
		<c:choose>
			<c:when test="${i == paging.currentPageNo}">
				<strong class="pageButton active">${i}</strong>
			</c:when>
			<c:otherwise>
				<a href="?page=${i}&searchType=${searchType}&keyword=${keyword}"
					class="pageButton">${i}</a>
			</c:otherwise>
		</c:choose>
	</c:forEach>

	<!-- 다음 블록: 현재 마지막 페이지가 총 페이지보다 작을 때만 출력 -->
	<c:if test="${paging.lastPageNoOnPageList < paging.totalPageCount}">
		<a
			href="?page=${paging.firstPageNoOnPageList + paging.pageSize}&searchType=${searchType}&keyword=${keyword}"
			class="pageButton">다음</a>
	</c:if>
</div>


