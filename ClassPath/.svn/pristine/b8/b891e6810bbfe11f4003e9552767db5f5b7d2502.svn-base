<%--
 * == 개정이력(Modification Information) ==
 * 수정일	수정자	수정내용
 * ========================================
 * 250716	양수민	최초 생성
--%>
<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@ taglib uri="jakarta.tags.core" prefix="c"%>

<link rel="stylesheet" href="/dist/assets/css/test/staffScholarshipApplyList2.css"> 
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" />

<title>학생 장학 신청 목록</title>

<div class="staffScholarshipApplyList">

	<div class="sectionHeaderLine">
		<div>
			<div class="sectionHeaderTitle">[ ${schTypeName } ] 신청 목록</div>
			
			<span class="sectionHeaderDescription">전체 ${count }개의 신청</span>
		</div>
	</div>
	
	<!-- 검색 및 필터 -->
    <div class="card">
	    <form method="get" action="/staff/scholarshipApply/staffScholarshipDetail.do">
	        <!-- schTypeNo도 hidden으로 전달 -->
	        <input type="hidden" name="schTypeNo" value="${param.schTypeNo}"/>
	
	        <div class="form-row">
	            <div class="form-group">
	                <select class="selectBox" id="statusFilter" name="applyStatus">
	                    <option value="" ${empty applyStatus ? 'selected' : ''}>처리 상태</option>
	                    <option value="신청대기" ${applyStatus == '신청대기' ? 'selected' : ''}>신청대기</option>
	                    <option value="승인" ${applyStatus == '승인' ? 'selected' : ''}>승인</option>
	                    <option value="반려" ${applyStatus == '반려' ? 'selected' : ''}>반려</option>
	                </select>
	            </div>
	            <div class="form-group">
	                <select class="selectBox" name="searchType">
	                    <option value="all" ${searchType == 'all' ? 'selected' : ''}>검색 항목</option>
	                    <option value="userNo" ${searchType == 'userNo' ? 'selected' : ''}>학번</option>
	                    <option value="userName" ${searchType == 'userName' ? 'selected' : ''}>학생명</option>
	                </select>
	            </div>
	            <div class="form-group">
	                <input type="text" class="inputField" name="keyword" id="searchInput" placeholder="검색어 입력" value="${keyword}">
	            </div>
	            <div class="form-group">
	                <button class="searchButton" type="submit">
<!-- 	                    <i class="fas fa-search"></i> 검색 -->
	                    검색
	                </button>
	            </div>
	        </div>
	    </form>
	</div>
	
	<div class="tableContainer">
		<table class="defaultTable">
			<thead class="tableHead">
				<tr>
					<th class="tableTh">번호</th>
					<th class="tableTh">학번</th>
					<th class="tableTh">신청자명</th>
					<th class="tableTh">신청 일자</th>
					<th class="tableTh">신청 상태</th>
					<th class="tableTh">처리 일자</th>
					<th class="tableTh">첨부파일</th>
					<th class="tableTh">처리상태</th>
				</tr>
			</thead>
			<tbody>
			<c:choose>
	        <c:when test="${not empty scholarshipApplyList }">
				<c:forEach items="${scholarshipApplyList }" var="scholarshipApplyList" varStatus="status">
					<c:url value="/staff/scholarshipApply/staffScholarshipUpdate.do" var="detailURL">
						<c:param name="no" value="${scholarshipApplyList.applyNo }"/>
					</c:url>
					<tr onclick="location.href='${detailURL }'" class="tableRowHover">
						<td class="tableTd">${status.index+1 }</td>
						<td class="tableTd">${scholarshipApplyList.userNo }</td>
						<td class="tableTd">${scholarshipApplyList.user.userName }</td>
						<td class="tableTd">${scholarshipApplyList.requestDate }</td>
						<td class="tableTd">${scholarshipApplyList.applyStatus }</td>
						<td class="tableTd">${scholarshipApplyList.approveDate }</td>
						<td class="tableTd">
							<c:if test="${not empty scholarshipApplyList.fileRefNo}">
						        <a download href="/student/scholarship/fileDownload.do?fileRefNo=${scholarshipApplyList.fileRefNo}"><i class="fas fa-download"></i> 다운로드</a>
						    </c:if>
						</td>
						<td class="tableTd">
							<c:if test="${scholarshipApplyList.applyStatus eq '반려'}">
						        <span class="badge badgeRed">${scholarshipApplyList.applyStatus}</span>
						        <input type="hidden" name="schTypeNo" value="${scholarshipApplyList.applyStatus}">
						    </c:if>
							<c:if test="${scholarshipApplyList.applyStatus eq '승인'}">
						        <span class="badge badgeGreen">${scholarshipApplyList.applyStatus}</span>
						    </c:if>
							<c:if test="${scholarshipApplyList.applyStatus eq '대기중'}">
						        <span class="badge badgeGray">${scholarshipApplyList.applyStatus}</span>
						    </c:if>
						</td>
					</tr>
				</c:forEach>
			</c:when>
			<c:otherwise>
	          <tr>
	            <td colspan="8" class="tableTd noticeInfo">아직 신청된 장학금 목록이 존재하지 않습니다.</td>
	          </tr>
	        </c:otherwise>
	      </c:choose>
			</tbody>
		</table>
	</div>
	
	<div class="pagination">
		<c:if test="${paging.currentPageNo > 10}">
			<a href="?page=${paging.firstPageNoOnPageList - paging.pageSize}&keyword=${keyword}" class="pageButton">이전</a>
		</c:if>
	
		<c:forEach var="i" begin="${paging.firstPageNoOnPageList}" end="${paging.lastPageNoOnPageList}">
			<c:choose>
				<c:when test="${i == paging.currentPageNo}">
					<strong class="pageButton active">${i}</strong>
				</c:when>
				<c:otherwise>
					<a href="?page=${i}&keyword=${keyword}" class="pageButton">${i}</a>
				</c:otherwise>
			</c:choose>
		</c:forEach>
	
		<c:if test="${paging.currentPageNo < paging.totalPageCount}">
			<a href="?page=${paging.firstPageNoOnPageList + paging.pageSize}&keyword=${keyword}" class="pageButton">다음</a>
		</c:if>
	</div>
</div>