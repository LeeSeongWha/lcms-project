<%--
 * == 개정이력(Modification Information) ==
 * 수정일	수정자	수정내용
 * ========================================
 * 250705	서경덕	최초 생성
--%>
<%@ page language="java" contentType="text/html; charset=UTF-8"
	pageEncoding="UTF-8"%>
<%@ taglib uri="jakarta.tags.core" prefix="c"%>

<title>성적 조회</title>
<link rel="stylesheet" href="/dist/assets/css/bodyFormat.css">

<script>
	document.addEventListener("DOMContentLoaded", () => {
		const CPATH = document.body.dataset.contextPath;
		const pHakgi = document.querySelector("#pHakgi");
		const initVal = pHakgi.dataset.initVal;
		
		console.log("체로롱 :", initVal);
	
		axios.get(`${CPATH}/student/grade/semesterList.do`).then(resp => {
			const semesterList = resp.data;
			
			console.log(semesterList);
	
			if (semesterList) {
				// term 값만 추출
				const termSet = new Set();
		       
				// 중복 제거된 term 배열로 변환
				semesterList.forEach(item => {
		            termSet.add(item.term);
		        });
				
				// 중복 제거된 term 배열로 변환
		        const uniqueTerms = Array.from(termSet);
				
				// option 태그 생성
		        const options = uniqueTerms.map(term => `<option value="\${term}">\${term}</option>`)
		            					   .join("\n");

				pHakgi.innerHTML += options;
				
				pHakgi.value = initVal ?? "";
			}
		}).catch(err => {
			console.error("학기 목록 로드 실패:", err);
		});
	});
</script>

<div>
	<div class="form-row" style="display: flex; gap: 1.25rem;">
    	<div class="form-group" style="flex: 1;">
			<label for="pHaknyeondo" class="inputLabel">년도</label> 
			<input type="number" id="pHaknyeondo" class="inputField" value="2025">
		</div>

    	<div class="form-group" style="flex: 1;">
			<label for="pHakgi" class="inputLabel">학기</label>
			<select id="pHakgi" name="pHakgi" class="form-select" data-init-val="">
				<option value="">학기 선택</option>
			</select>
		</div>
		<div class="form-group" style="flex: 1;">
			<label class="inputLabel">전체</label>
				<input type="checkbox" class="checkbox" name="allTimeYn" id="allTimeYn" true-value="Y" false-value="N" style="margin-top:10px;"> 
				<label>전체 성적</label>
		</div>
	</div>
</div>
<br>
<div class="tableContainer">
	<table class="defaultTable">
		<thead class="tableHead">
			<tr>
				<th class="tableTh">학기</th>
				<th class="tableTh">과목</th>
				<th class="tableTh">학점</th>
				<th class="tableTh">등급</th>
				<th class="tableTh">평점</th>
			</tr>
		</thead>
		<tbody>
			<c:forEach items="${lectureEnrList }" var="lectureEnr">
				<tr>
					<td class="tableTd">${lectureEnr.semesterName }</td>
					<td class="tableTd">${lectureEnr.subject.subjectName }</td>
					<td class="tableTd">${lectureEnr.subject.credit }</td>
					<td class="tableTd">${lectureEnr.grade }</td>
					<td class="tableTd">${lectureEnr.gradePoint }</td>
				</tr>
			</c:forEach>
		</tbody>
	</table>
</div>